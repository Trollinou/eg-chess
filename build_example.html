<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EGChess "Build" Mode Example</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cm-chessboard@8.10.1/assets/chessboard.css">
    <link rel="stylesheet" href="dist/eg-chess.css">
    <style>
        body { font-family: sans-serif; }
        #board-container { width: 400px; height: 400px; }
        #fen-container { margin-top: 10px; }
        #fen-input { width: 100%; box-sizing: border-box; }
        #arrow-container { margin-top: 10px; }
        #arrow-input { width: 100%; box-sizing: border-box; }
        #marker-container { margin-top: 10px; }
        #marker-input { width: 100%; box-sizing: border-box; }
    </style>
    <script type="importmap">
    {
      "imports": {
        "cm-chessboard": "https://cdn.jsdelivr.net/npm/cm-chessboard@8.10.1/src/Chessboard.js",
        "cm-chessboard/": "https://cdn.jsdelivr.net/npm/cm-chessboard@8.10.1/",
        "chess.js": "https://cdn.jsdelivr.net/npm/chess.js@1.4.0/+esm"
      }
    }
    </script>
</head>
<body>
    <h1>EGChess "Build" Mode Example</h1>
    <p>Click on a square to add a piece, double-click a piece to remove it, or drag pieces to move them.</p>
    <div id="board-container"></div>
    <div id="fen-container">
        <label for="fen-input">Current FEN:</label>
        <input type="text" id="fen-input" readonly>
    </div>
    <div id="arrow-container">
        <label for="arrow-input">Current Arrow:</label>
        <input type="text" id="arrow-input" readonly>
    </div>
    <div id="marker-container">
        <label for="marker-input">Current Marker:</label>
        <input type="text" id="marker-input" readonly>
    </div>

    <script type="module">
        import { EGChess } from './dist/eg-chess.js';

        const boardContainer = document.getElementById('board-container');
        const fenInput = document.getElementById('fen-input');
        const arrowInput = document.getElementById('arrow-input');
        const markerInput = document.getElementById('marker-input');

        // Initialize EGChess in "build" mode
        const egChess = new EGChess(boardContainer, 'build');

        // Function to update the FEN input
        const updateFen = () => {
            const fen = egChess.getFen();
			const arrows = egChess.getArrows();
			const markers = egChess.getMarkers();
            fenInput.value = fen;
			arrowInput.value = JSON.stringify(arrows);
			markerInput.value = JSON.stringify(markers);
        };

        // Listen for the 'onChange' event
        egChess.on('onChange', (fen) => {
            console.log('onChange event fired with FEN:', fen);
            updateFen();
        });

        // Set the initial FEN value
        updateFen();
    </script>
</body>
</html>
